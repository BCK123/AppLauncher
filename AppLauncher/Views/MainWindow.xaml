<Window x:Class="AppLauncher.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:AppLauncher.ViewModels" xmlns:converters="clr-namespace:AppLauncher.Converters"
        Title="AppLauncher" Height="520" Width="420">
    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>
    <Window.Resources>
        <ResourceDictionary>
            <converters:IconPathToImageConverter x:Key="IconPathToImageConverter"/>

            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="\Resources\Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>

    </Window.Resources>


    <DockPanel>

        <!-- 顶部栏：Grid布局 + 引用样式 -->
        <Grid DockPanel.Dock="Top" Height="60" Background="White" 
              HorizontalAlignment="Stretch">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- 标题 -->
                <ColumnDefinition Width="*"/>
                <!-- 占满中间 -->
                <ColumnDefinition Width="Auto"/>
                <!-- 右侧按钮 -->
            </Grid.ColumnDefinitions>


            <!-- 标题 -->
            <!-- 左侧标题 -->
            <TextBlock Grid.Column="0"
               Text="AppLauncher"
               Style="{StaticResource TopTitleTextStyle}"
               VerticalAlignment="Center"
               Margin="12,0"/>

            <!-- 右侧按钮区（关键：放在第 2 列） -->
            <StackPanel Grid.Column="2"
                Orientation="Horizontal"
                VerticalAlignment="Center"
                Margin="0,0,12,0"
                >

                <Button Style="{StaticResource IconButtonStyle}"
                ToolTip="添加"
                Click="BtnAdd_Click" Cursor="Hand">
                    <Image Source="/Resources/icons/setting.png"
                          
                   Width="18"
                   Height="18"/>
                </Button>

                <Button Style="{StaticResource IconButtonStyle}"
                ToolTip="设置"
                Click="BtnSettings_Click">
                    <Image Source="/Resources/icons/setting.png"
                   Width="18"
                   Height="18"/>
                </Button>
            </StackPanel>
        </Grid>


        <Border Margin="8" BorderBrush="Gray" BorderThickness="1" CornerRadius="4"
                AllowDrop="True" Background="WhiteSmoke"
                Drop="Border_Drop" DragOver="Border_DragOver">
            <ScrollViewer>
                <ItemsControl ItemsSource="{Binding Shortcuts}">

                    <!-- 关键：改成网格排列 -->
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <!--ItemsControl 用 StackPanel（垂直单列）展示子项，这里通过 ItemsPanelTemplate 替换为 WrapPanel（自动换行面板）-->
                            <WrapPanel IsItemsHost="True" HorizontalAlignment="Left"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>

                            <!-- 单一 Border（一个启动项） -->
                            <Border Width="96" Padding="8" Margin="6" CornerRadius="8" Cursor="Hand"      Style="{StaticResource BorderStyle}">

                                <StackPanel Orientation="Vertical"   HorizontalAlignment="Center">
                                    
                                    
                                    <!-- 图标 -->
                                    <Image Width="48" Height="48" Margin="4"
                           Source="{Binding IconPath, Converter={StaticResource IconPathToImageConverter}}"/>

                                    <!-- 名称 -->
                                    <TextBlock Text="{Binding DisplayName}"
                               Margin="0,6,0,0"
                               FontSize="12"
                               TextAlignment="Center"
                               TextWrapping="Wrap"
                               TextTrimming="CharacterEllipsis"
                                               
                               MaxWidth="80"/>
                                </StackPanel>

                                <!-- 单击启动 -->
                                <Border.InputBindings>
                                    <MouseBinding MouseAction="LeftClick"
                                  Command="{Binding DataContext.ItemDoubleClickCommand,
                                            RelativeSource={RelativeSource AncestorType=Window}}"
                                  CommandParameter="{Binding}"/>
                                </Border.InputBindings>

                            </Border>

                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>

            </ScrollViewer>
        </Border>
    </DockPanel>
</Window>
